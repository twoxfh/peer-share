var V=Object.defineProperty;var Y=(s,e,r)=>e in s?V(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r;var p=(s,e,r)=>(Y(s,typeof e!="symbol"?e+"":e,r),r);import{S as L,i as E,s as O,e as f,t as S,a as y,b as k,c as b,d as u,f as A,l as v,g as G,n as _,h as P,r as R,j,k as F,m as I,o as J,p as d,q as h,u as W,v as Q,w as N,P as X,x as Z,y as $,z as T}from"./vendor.fd7ae926.js";const x=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const t of i.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&o(t)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}};x();function ee(s){let e,r,o,n,i,t,c,l,w,a,C,z;return{c(){e=f("div"),r=f("div"),o=S("Your peer id is "),n=S(s[0]),i=y(),t=f("label"),c=S("Connect to "),l=f("input"),w=y(),a=f("button"),a.textContent="Connect",k(l,"type","text"),k(e,"class","container")},m(m,g){b(m,e,g),u(e,r),u(r,o),u(r,n),u(e,i),u(e,t),u(t,c),u(t,l),A(l,s[1]),u(e,w),u(e,a),C||(z=[v(l,"input",s[5]),v(a,"click",s[6])],C=!0)},p(m,[g]){g&1&&G(n,m[0]),g&2&&l.value!==m[1]&&A(l,m[1])},i:_,o:_,d(m){m&&P(e),C=!1,R(z)}}}function ne(s,e,r){let{id:o}=e,{peer:n}=e,{connection:i}=e,t="";function c(){let a=n.connect(t,{reliable:!0,serialization:"binary"});a.on("open",()=>r(3,i=a))}function l(){t=this.value,r(1,t)}const w=()=>c();return s.$$set=a=>{"id"in a&&r(0,o=a.id),"peer"in a&&r(4,n=a.peer),"connection"in a&&r(3,i=a.connection)},[o,t,c,i,n,l,w]}class te extends L{constructor(e){super();E(this,e,ne,ee,O,{id:0,peer:4,connection:3})}}const q=5*1024*1024;function B(s){return Math.ceil(s/q)}async function re(s,e,r){const o=r!=null?r:B(s.size);if(e>=o)throw new Error("Chunk out of bounds");return e!==o-1?await s.slice(e*q,(e+1)*q).arrayBuffer():await s.slice(e*q).arrayBuffer()}async function*oe(s){const e=B(s.size);for(let r=0;r<e;r++)yield await re(s,r,e)}let D=Promise.resolve();async function H(){await D;let s={};return D=s.promise=new Promise(e=>s.releaseLock=e),s}j.mitm="https://vigneshpa.github.io/stream-saver-mitm/";class ie{constructor(e){p(this,"reqres");p(this,"streamPull");this.connection=e,this.reqres=new se(e,this.requestHandler.bind(this)),this.streamPull=null}async requestHandler(e){if(e==="stream-pull"){if(!this.streamPull)throw new Error("Currently not streaming");return await this.streamPull()}if(e.filename){const{filename:r,size:o}=e;if(!confirm(`Do you want to download
`+r))return"canceled";const n=this,i=new ReadableStream({async pull(c){const l=await n.reqres.request("stream-pull");l==="stop"?c.close():c.enqueue(new Uint8Array(l))}}),t=j.createWriteStream(r,{size:o});return i.pipeTo(t),"accepted"}}async sendFile(e){if(this.streamPull)throw new Error("Already streaming another file");if(await this.reqres.request({filename:e.name,size:e.size})==="accepted"){const o=oe(e);this.streamPull=async()=>{const{value:n,done:i}=await o.next();if(n)return n;if(i)return this.streamPull=null,"stop";throw new Error("No value got")}}}}class se{constructor(e,r){p(this,"connection");p(this,"resolver");p(this,"request");this.connection=e,this.resolver=null,this.connection.on("data",async o=>{if(o.response&&this.resolver(o.message),o.request){const n=await H(),i=await r(o.message);this.connection.send({response:!0,message:i}),n.releaseLock()}}),this.request=async o=>{const n=await H();return new Promise(i=>{this.connection.send({request:!0,message:o}),this.resolver=t=>{n.releaseLock(),i(t)}})}}}function ce(s){let e,r,o,n,i,t;return{c(){e=f("div"),r=f("input"),o=y(),n=f("button"),n.textContent="Send",k(r,"type","file"),r.multiple=!0,k(e,"class","container")},m(c,l){b(c,e,l),u(e,r),u(e,o),u(e,n),i||(t=[v(r,"change",s[3]),v(n,"click",s[1])],i=!0)},p:_,i:_,o:_,d(c){c&&P(e),i=!1,R(t)}}}function le(s,e,r){let{connection:o}=e,n;const i=new ie(o);async function t(){for(let l of n)i.sendFile(l)}function c(){n=this.files,r(0,n)}return s.$$set=l=>{"connection"in l&&r(2,o=l.connection)},[n,t,o,c]}class ae extends L{constructor(e){super();E(this,e,le,ce,O,{connection:2})}}function M(s){let e,r,o;function n(t){s[3](t)}let i={peer:s[0],id:s[1]};return s[2]!==void 0&&(i.connection=s[2]),e=new te({props:i}),Z.push(()=>$(e,"connection",n)),{c(){F(e.$$.fragment)},m(t,c){I(e,t,c),o=!0},p(t,c){const l={};c&1&&(l.peer=t[0]),c&2&&(l.id=t[1]),!r&&c&4&&(r=!0,l.connection=t[2],J(()=>r=!1)),e.$set(l)},i(t){o||(d(e.$$.fragment,t),o=!0)},o(t){h(e.$$.fragment,t),o=!1},d(t){W(e,t)}}}function K(s){let e,r;return e=new ae({props:{connection:s[2]}}),{c(){F(e.$$.fragment)},m(o,n){I(e,o,n),r=!0},p(o,n){const i={};n&4&&(i.connection=o[2]),e.$set(i)},i(o){r||(d(e.$$.fragment,o),r=!0)},o(o){h(e.$$.fragment,o),r=!1},d(o){W(e,o)}}}function ue(s){let e,r,o,n=!s[2]&&s[1]&&M(s),i=s[2]&&K(s);return{c(){n&&n.c(),e=y(),i&&i.c(),r=Q()},m(t,c){n&&n.m(t,c),b(t,e,c),i&&i.m(t,c),b(t,r,c),o=!0},p(t,[c]){!t[2]&&t[1]?n?(n.p(t,c),c&6&&d(n,1)):(n=M(t),n.c(),d(n,1),n.m(e.parentNode,e)):n&&(T(),h(n,1,1,()=>{n=null}),N()),t[2]?i?(i.p(t,c),c&4&&d(i,1)):(i=K(t),i.c(),d(i,1),i.m(r.parentNode,r)):i&&(T(),h(i,1,1,()=>{i=null}),N())},i(t){o||(d(n),d(i),o=!0)},o(t){h(n),h(i),o=!1},d(t){n&&n.d(t),t&&P(e),i&&i.d(t),t&&P(r)}}}function fe(s,e,r){let o;o=new X;let n="";o.on("open",c=>console.log(r(1,n=c)));let i;o.on("connection",c=>c.on("open",()=>r(2,i=c))),window.addEventListener("beforeunload",c=>o.destroy()),o.on("error",c=>console.error(c));function t(c){i=c,r(2,i)}return[o,n,i,t]}class de extends L{constructor(e){super();E(this,e,fe,ue,O,{})}}const me="modulepreload",U={},pe="/peer-share/",he=function(e,r){return!r||r.length===0?e():Promise.all(r.map(o=>{if(o=`${pe}${o}`,o in U)return;U[o]=!0;const n=o.endsWith(".css"),i=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${i}`))return;const t=document.createElement("link");if(t.rel=n?"stylesheet":me,n||(t.as="script",t.crossOrigin=""),t.href=o,document.head.appendChild(t),n)return new Promise((c,l)=>{t.addEventListener("load",c),t.addEventListener("error",l)})})).then(()=>e())};async function _e(){if(!window.WritableStream){const s=await he(()=>import("./ponyfill.es2018.3a0cf7e4.js"),[]);for(const e in s)Object.prototype.hasOwnProperty.call(s,e)&&(window[e]=s[e])}}function we(){window.app=new de({target:document.body})}_e().then(we);
